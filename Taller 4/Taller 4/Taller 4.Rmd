---
title: "Taller 4"
author: "Julian Velandia, Julian Albarracín, Tomas Bermudez"
date: "`r Sys.Date()`"
output: 
  html_document:
    toc: true
    toc_float: true
    number_sections: true
    theme: darkly
    css: estilo.css
---

```{r echo=FALSE, message=FALSE}
library(ggplot2)
```

# Desarrollo

## Primer punto

***Enunciado: *** Una variable aleatoria $X$ que toma los valores $x_1, x_2, \ldots, x_n$ se denomina variable aleatoria discreta uniforme si su función de masa de probabilidad es:

$$
f(x) = 
\begin{cases}
    1/k & \text{para todas las variables } x_1, x_2, \ldots, x_k \\
    0 & \text{en cualquier otro caso.}
\end{cases}
$$
Calcule la media y la varianza de $X$.

***Solución: ***
$$
\begin{align*}
\mu &= E(X) \\
&= \sum_{i=1}^{k} x_i P(x_i) \\
&= \sum_{i=1}^{k} x_i \left(\frac{1}{k}\right) \\
&= \frac{1}{k} \sum_{i=1}^{k} x_i
\end{align*}
$$

Por lo que la media es el mismo valor esperado.

Una vez tenemos el valor esperado podemos aplicar la fórmula de $\sigma^2 = E(X^2) - [E(X)]^2$ para encontrar la varianza.

## Segundo punto

***Enunciado: *** De acuerdo con un artículo de una revista importante, aproximadamente 30% de todas las fallas de operación en las tuberías de plantas químicas son ocasionadas por errores del operador.

  1. ¿Cuál es la probabilidad de que de las siguientes 20 fallas en las tuberías al menos 10 se deban a un error del operador?
  2. ¿Cuál es la probabilidad de que no más de 4 de 20 fallas se deban a un error del operador?

***Solución: ***
$$
P(X \ge 10) = \sum_{i=10}^{20} \binom{20}{i} (0.3)^i (0.7)^{20-i}
$$

$$
P(X \le 4) = \sum_{i=0}^{4} \binom{20}{i} (0.3)^i (0.7)^{20-i}
$$

```{r echo=FALSE,  fig.align="center"}
n <- 20 # número de fallas

p <- 0.3 # probabilidad de éxito (la falla es ocasionada por el operador)

x <- 0:20 # valores que puede tomar x

# P(X>=10)

sol1 <- pbinom(q = 9,size = n, prob = p,lower.tail = FALSE)
cat("P(X>=10) = ",sol1)

#P(X<=4)

sol2 <- pbinom(q = 4,size = n, prob = p,lower.tail = TRUE)
cat("P(X<=4) = ",sol2)

#para la grafica

f.1 <- dbinom(x,size = n, prob = p)

df1 <- data.frame(x, f.1)

ggplot(df1, aes(x, f.1))+
  geom_point(col="darkblue")+
  geom_segment(x = x, xend=x, y = 0, yend=f.1,linetype = "dashed", col="brown")+
  labs(title = "Función de probabilidad de fallas ocasionadas por un operador")
```


## Tercer punto

***Enunciado: *** Suponga que los motores de un avión operan de forma independiente y que tienen una probabilidad de falla de 0.4. Se supone que un avión tiene un vuelo seguro si funcionan al menos la mitad de sus motores. Si un avión tiene 4 motores y otro tiene 2, ¿cuál de los dos tiene la probabilidad más alta de un vuelo exitoso?

***Solución: ***
$$
\begin{aligned}
\text{Para 4 motores: } & P(\text{éxito}) = P(X \ge 2) = \sum_{i=2}^{4} \binom{4}{i} (0.6)^i (0.4)^{4-i} \\
& = 0.8208 \\
\text{Para 2 motores: } & P(\text{éxito}) = P(Y \ge 1) = \sum_{i=1}^{2} \binom{2}{i} (0.6)^i (0.4)^{2-i} \\
& = 0.84 \\
\end{aligned}
$$

```{r echo=FALSE, fig.align="center"}
n <- 4 # número de motores

p <- 0.6 # probabilidad de éxito (no falla un motor : 1-0.4)

x <- 0:4 # valores que puede tomar x

# P(X>=2)

sol1 <- pbinom(q = 1,size = n, prob = p,lower.tail = FALSE)
cat("Avion con 4 motores: P(X>=2) = ",sol1)

# grafica

f.2 <- dbinom(x,size = n, prob = p)

df2 <- data.frame(x, f.2)

ggplot(df2, aes(x, f.2))+
  geom_point(col="darkblue")+
  geom_segment(x = x, xend=x, y = 0, yend=f.2,linetype = "dashed", col="brown")+
  labs(title = "Función de probabilidad de fallas por motor en avión de 4 motores")
```

```{r echo=FALSE, fig.align="center"}
n <- 2 # número de motores

p <- 0.6 # probabilidad de éxito (no falla un motor : 1-0.4)

x <- 0:2 # valores que puede tomar x

# P(X>=1)

sol2 <- pbinom(q = 0,size = n, prob = p,lower.tail = FALSE)
cat("Avion con 2 motores: P(X>=1) = ",sol2)

#grafica
f.2 <- dbinom(x,size = n, prob = p)

df2 <- data.frame(x, f.2)

ggplot(df2, aes(x, f.2))+
  geom_point(col="darkblue")+
  geom_segment(x = x, xend=x, y = 0, yend=f.2,linetype = "dashed", col="brown")+
  labs(title = "Función de probabilidad de fallas por motor en avión de 2 motores")
```

De acuerdo a lo anterior, el avión con 2 motores tiene una mayor probabilidad

## Cuarto punto

***Enunciado: *** Para evitar la detección en la aduana, un viajero coloca 6 comprimidos con narcóticos en una botella que contiene 9 píldoras de vitamina que aparentemente son similares. Si el oficial de la aduana selecciona 3 de las tabletas al azar para su análisis, ¿cuál es la probabilidad de que el viajero sea arrestado por posesión ilegal de narcóticos?

***Solución: ***
```{r echo=FALSE,  fig.align="center"}
m <- 6

n <- 9

k <- 3

# P(X>=1) = P(X>0)

sol3 <- phyper(q = 0,m = m, n = n, k = k, lower.tail = FALSE)
cat("La probabilidad de que el viajero sea arrestado es de: ", sol3)

#grafica
x <- c(max(0,k-n):min(k,m))

f.3 <- dhyper(x = x, m = m, n = n, k = k)
df3 <- data.frame(x, f.3)

ggplot(df3, aes(x, f.3)) +
  geom_point(col="darkblue") +
  geom_segment(x = x, xend = x, y = 0, yend = f.3, linetype = "dashed", col = "purple")+
  labs(title = "Gráfica de la probabilidad de encontrar la droga")
```

## Quinto punto

***Enunciado: *** Se selecciona al azar un comité de 3 personas a partir de 4 médicos y 2 enfermeras. Escriba una fórmula para la distribución de probabilidad de la variable aleatoria $X$ que representa el número de médicos en el comité. Calcule $P(2 ≤ X ≤ 3)$

***Solución: ***
$P(X = x) = \frac{\binom{4}{x}\binom{2}{3-x}}{\binom{6}{3}}$

Como la cantidad de seleccionados es 3, solo tenemos que hallar la probabilidad de que halla dos o más medicos, o sea más de un médico

```{r echo=FALSE, fig.align="center"}
m <- 4 # medicos

n <- 2

k <- 3

# P(2 <= X <= 3)
sol4 <- phyper(q = 1,m = m, n = n, k = k, lower.tail = FALSE)
cat("La probabilidad de haya entre 2 y 3 médicos en el comité es: ", sol4)

#grafica
x <- c(max(0,k-n):min(k,m))

f.4 <- dhyper(x = x, m = m, n = n, k = k)
df4 <- data.frame(x, f.4)

ggplot(df4, aes(x, f.4)) +
  geom_point(col="darkblue") +
  geom_segment(x = x, xend = x, y = 0, yend = f.4, linetype = "dashed", col = "purple")+
  labs(title = "Gráfica de la probabilidad de seleccion de los médicos")
```


## Sexto punto

***Enunciado: *** De un lote de 10 misiles, se seleccionan 4 al azar y se disparan. Si el lote contiene 3 misiles defectuosos que no pueden dispararse, ¿cuál es la probabilidad de que:

  1. Los 4 puedan dispararse?
  2. A lo sumo fallen 2?

***Solución: ***

```{r echo=FALSE, fig.align="center"}
m <- 3 # misiles defectuosos 

n <- 7 

k <- 4

# P(X = 0) X es la cantidad de fallas
sol5 <- dhyper(x = 0,m = m, n = n, k = k)
cat("La probabilidad de que los 4 misiles sirvan es: ", sol5)

# P(X <= 2)
sol5 <- phyper(q = 2,m = m, n = n, k = k)
cat("La probabilidad de que a lo sumo dos fallen es: ", sol5)

#grafica
x <- c(max(0,k-n):min(k,m))

f.5 <- dhyper(x = x, m = m, n = n, k = k)
df5 <- data.frame(x, f.5)

ggplot(df5, aes(x, f.5)) +
  geom_point(col="darkblue") +
  geom_segment(x = x, xend = x, y = 0, yend = f.5, linetype = "dashed", col = "purple")+
  labs(title = "Gráfica de la probabilidad de seleccion de misiles defectuosos")
```

## Septimo punto

***Enunciado: *** En cierto crucero ocurren, en promedio, 3 accidentes de tránsito al mes. ¿Cuál es la probabilidad de que en cualquier determinado mes en este crucero

  1. ocurran exactamente 5 accidentes?
  2. ocurran menos de 3 accidentes?
  3. ocurran al menos 2 accidentes?

***Solución: ***

```{r echo=FALSE, fig.align="center"}
l <- 3

x <- 0:10

sol6 <- dpois(5,lambda = l)
cat("La probabilidad de que ocurran 5 accidentes es:", sol6)

sol6 <- ppois(2,lambda = l)
cat("La probabilidad de que ocurran menos de 3 accidentes es:", sol6)

sol6 <- ppois(1,lambda = l, lower.tail = FALSE)
cat("La probabilidad de que ocurran al menos 2 accidentes es:", sol6)

f.p <- dpois(x,lambda = l)

df.p <- data.frame(x,f.p)

ggplot(df.p, aes(x, f.p))+
  geom_point(col = "darkblue")+
  geom_segment(x = x, xend = x, y = 0, yend = f.p, linetype = "dashed", col="skyblue")+
  labs(title = "Gráfica de la función de probabilidad de una Poisson")
```

## Octavo punto

***Enunciado: *** Los cambios en los procedimientos de los aeropuertos requieren una planeación considerable. Los índices de llegadas los aviones son factores importantes que deben tomarse en cuenta. Suponga que los aviones pequeños llegan a cierto aeropuerto, de acuerdo con un proceso de Poisson, con una frecuencia de 6 por hora. De esta manera, el parámetro de Poisson para las llegadas en un periodo de horas es μ = 6t.

  1. ¿Cuál es la probabilidad de que lleguen exactamente 4 aviones pequeños durante un periodo de una hora?
  2. ¿Cuál es la probabilidad de que lleguen al menos 4 durante un periodo de una hora?
  3. Si definimos un día laboral como de 12 horas, ¿cuál es la probabilidad de que al menos 75 aviones pequeños lleguen durante un día laboral?

***Solución: ***

```{r echo=FALSE, fig.align="center"}
miu <- function(x) 6*x

l.1 <- miu(1) # en la primera hora

x.1 <- 0:10

sol7 <- dpois(4,lambda = l.1)
cat("La probabilidad de que lleguen 4 aviones en una hora:", sol7)

sol7 <- ppois(3,lambda = l.1, lower.tail = FALSE)
cat("La probabilidad de que lleguen 4 aviones en una hora:", sol7)

l.2 <- miu(12) # en las 12 horas
sol6 <- ppois(74,lambda = l.2, lower.tail = FALSE)
cat("La probabilidad de que lleguen por lo menos 75 aviones en las 12 horas es:", sol6)


f.p.1 <- dpois(x.1,lambda = l.1)

df.p.1 <- data.frame(x.1,f.p.1)

ggplot(df.p.1, aes(x.1, f.p.1))+
  geom_point(col = "darkblue")+
  geom_segment(x = x, xend = x, y = 0, yend = f.p.1, linetype = "dashed", col="skyblue")+
  labs(title = "Gráfica de la función de probabilidad aviones en una hora")

x.2 <- 0:100

f.p.2 <- dpois(x.2,lambda = l.2)

df.p.2 <- data.frame(x.2,f.p.2)

ggplot(df.p.2, aes(x.2, f.p.2))+
  geom_point(col = "darkblue")+
  geom_segment(x = x.2, xend = x.2, y = 0, yend = f.p.2, linetype = "dashed", col="skyblue")+
  labs(title = "Gráfica de la función de probabilidad de aviones en 12 horas")

```

# Notas

La personalización de este trabajo, es decir, la modificación del tema **darkly** mediante el archivo *css* fue posible gracias al trabajo cooperativo con Chatgpt, junto con su ayuda explicando como crear y personalizar las gráficas y funciones.

# Bibliografía

[Probabilidad y Estadística para Ingeniería y Ciencias (9a Edición)](https://bibliotecavirtualaserena.wordpress.com/wp-content/uploads/2017/05/libro_probabilidad-y-estadistica-para-ingenerc3ada-y-ciencias-ronald-e-walpole-mayers.pdf)

