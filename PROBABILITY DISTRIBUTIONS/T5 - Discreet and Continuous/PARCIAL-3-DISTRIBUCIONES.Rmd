---
title: "Parcial Distribuciones"
author: "Julian Velandia"
date: "`r Sys.Date()`"
output: html_document
---

## Primer punto
1. Un examen de opción múltiple tiene 15 preguntas, cada una con cinco posibles respuestas, sólo una de las cuales es correcta. Suponga que uno de los estudiantes que hace el examen contesta cada una de las preguntas con una adivinación aleatoria independiente. ¿Cuál es la probabilidad de que conteste correctamente al menos 6 preguntas?

```{r echo=FALSE,  fig.align="center"}
library(ggplot2)
n <- 15 # número de fallas

p <- 1/5 # probabilidad de éxito (la falla es ocasionada por el operador)

x <- 0:15 # valores que puede tomar x

# P(X>=6)

sol1 <- pbinom(q = 5,size = n, prob = p,lower.tail = FALSE)
cat("la probabilidad de que conteste correctamente al menos 6 preguntas P(X>=6) = ",sol1)

##grafica
f.1 <- dbinom(x,size = n, prob = p)

df1 <- data.frame(x, f.1)

ggplot(df1, aes(x, f.1))+
  geom_point(col="darkblue")+
  geom_segment(x = x, xend=x, y = 0, yend=f.1,linetype = "dashed", col="brown")+
  labs(title = "Función de probabilidad de que conteste correctamente a las preguntas")
```

## Segundo punto

Un aparato detector de incendios utiliza tres celdas sensibles a la temperatura que actúan de manera independiente una de otra, en forma tal que una o más pueden activar la alarma. Cada celda presenta una probabilidad de p = 0.7 de activar la alarma cuando la temperatura alcanza 100°C o más. Sea X igual al número de celdas que activan la alarma cuando la temperatura alcanza los 100°.
Encuentre la distribución de probabilidad para X y con base en ella, encuentre la probabilidad de que la alarma funcione cuando la temperatura alcance los 100°.

```{r echo=FALSE,  fig.align="center"}
n <- 3 # número de fallas

p <- 0.7 # probabilidad de éxito (la falla es ocasionada por el operador)

x <- 0:3 # valores que puede tomar x

# P(X>=6)

sol1 <- pbinom(q = 0,size = n, prob = p,lower.tail = FALSE)
cat("la probabilidad de que la alarma funcione cuando la temperatura alcance los 100° P(X > 0) = ",sol1)

##grafica
f.1 <- dbinom(x,size = n, prob = p)

df1 <- data.frame(x, f.1)

ggplot(df1, aes(x, f.1))+
  geom_point(col="darkblue")+
  geom_segment(x = x, xend=x, y = 0, yend=f.1,linetype = "dashed", col="brown")+
  labs(title = "Función de probabilidad de la alarma cuando alcance los 100°")
```

## Tercer punto

Un almacén contiene diez máquinas impresoras, cuatro de las cuales son defectuosas. Una compañía selecciona cinco de las máquinas al azar pensando que todas están en buenas condiciones. ¿Cuál es la probabilidad de que las cinco no sean defectuosas?

```{r echo=FALSE,  fig.align="center"}
m <- 6

n <- 4

k <- 5

## P(X = 0)
sol3 <- dhyper(x = 5, m = 6, n = 4, k = 5)
cat("La probabilidad de que las cinco no sean defectuosas es:", sol3)

#grafica
x <- c(max(0,k-n):min(k,m))

f.3 <- dhyper(x = x, m = m, n = n, k = k)
df3 <- data.frame(x, f.3)

ggplot(df3, aes(x, f.3)) +
  geom_point(col="darkblue") +
  geom_segment(x = x, xend = x, y = 0, yend = f.3, linetype = "dashed", col = "pink3")+
  labs(title = "Gráfica de la probabilidad de maquinas no defectuosas")
```
## Cuarto punto

Para el ejercicio 3, la compañía repara las impresoras defectuosas a un costo de $50 cada una.
Encuentre la media y la varianza del costo total de reparación. (Redondee al entero más cercano)

```{r echo=FALSE,  fig.align="center"}
m <- 6

n <- 4

k <- 5

# Costo promedio
media <- k * n / (m + n)
# E[Y]= a * E[X]
costo_medio <- 50 * media
cat("Costo medio de reparación:", costo_medio)

# Varianza
varianza <- k * (n / (m + n)) * (m / (m + n)) * ((m + n - k) / (m + n - 1))
#Var(Y)= (a**2) * Var(X)
costo_varianza <- 50^2 * varianza

cat("Varianza del costo total de reparación:", round(costo_varianza))
```
## Quinto punto

5. Llegan clientes a un mostrador de salida en una tienda de departamentos de acuerdo con una distribución de Poisson, a un promedio de siete por hora. Durante una hora determinada, ¿Cuál es la probabilidad de que no lleguen más de tres clientes?

```{r echo=FALSE, fig.align="center"}
l <- 7

# P(X <= 3)
sol6 <- ppois(3,lambda = l)
cat("La probabilidad de que no lleguen más de tres clientes es:", sol6)

##Grafica
x <- 0:14
f.p <- dpois(x,lambda = l)

df.p <- data.frame(x,f.p)

ggplot(df.p, aes(x, f.p))+
  geom_point(col = "darkblue")+
  geom_segment(x = x, xend = x, y = 0, yend = f.p, linetype = "dashed", col="skyblue")+
  labs(title = "Probabilidad de clientes que llegan a la tienda en una hora")
```

## Sexto punto

6. Al estudiar bajas cotizaciones para contratos de embarques, una empresa fabricante de microcomputadoras encuentra que los contratos interestatales tienen bajas cotizaciones que están uniformemente distribuidas entre 20 y 25, en unidades de miles de dólares. Encuentre la probabilidad de que la baja cotización en el siguiente contrato interestatal sea de más de $24,000.

```{r echo=FALSE, fig.align="center"}
min <- 20
max <- 25

## P(X >= 24)
sol7 <- punif(q = 24,min = min,max = max,lower.tail = FALSE)
cat("La probabilidad de que la baja cotización en el siguiente contrato interestatal sea de más de $24,000 es:", sol7)

##Grafica
x <- seq(20, 25, by = 0.01)
f.p <- dunif(x, min = min, max = max)

df.u <- data.frame(x,f.p)

ggplot(df.u,aes(x,f.p)) +
  geom_line(col='darkblue') +
  geom_segment(x = 20,y = 0,xend = 20,yend = dunif(24, min = 20, max = 25), linetype='dashed', col="brown") +
  geom_segment(x = 25,y = 0,xend = 25,yend = dunif(25, min = 20, max = 25), linetype='dashed', col = "brown") +
  geom_ribbon(data = subset(df.u, x >= 24),
                         aes(x = x, ymin = 0, ymax = f.p),
                         inherit.aes = FALSE,
                         fill = "purple4", alpha = 0.6) +
  labs(title = "Distribución Uniforme de cotizaciones entre 20 y 24 mil dolares",subtitle =  "P(X >= 24)")
```

## Septimo punto

7. Se supone que las calificaciones de un examen están normalmente distribuidas con media de 78 y varianza de 36. Suponga que los estudiantes que alcancen el 10% más alto de esta distribución reciben una calificación de A. ¿Cuál es la calificación mínima que un estudiante debe recibir para ganar una calificación de A?

```{r echo=FALSE, fig.align="center"}
mean7 <- 78
varianza7 <- 36; varianza7

## P(X >= 90%)
sol8 <- qnorm(0.90, mean = mean7, sd = sqrt(varianza7))
cat("La nota mínima para una A es:", sol8)

##Grafica
x. <- rnorm(n = 1000,mean = mean7,sd = sqrt(varianza7))   ## Genero 1000 datos aleatorios
y. <- dnorm(x = x., mean = mean7, sd = sqrt(varianza7))   ## Aplico la función normal
df1 <- data.frame(x.,y.)

ggplot(df1, aes(x=x., y=y.))+
  geom_line(col = "skyblue4") +
  geom_segment(x = mean7, xend= mean7, y = 0, yend = dnorm(78, mean = mean7, sd = sqrt(varianza7)), linetype = "dashed", col = "green3")+
  labs(title = "Grafica normal de las calificaiones de examenes con media = 78, sd = 6") +
  theme_minimal()
```

## Octavo punto

8. Los exámenes de admisión de la Unal se aplican a miles de estudiantes cada
semestre. Las secciones de matemáticas de cada uno de estos exámenes producen calificaciones que están normalmente distribuidas, en forma aproximada. En años recientes las calificaciones de exámenes de matemáticas han promediado 480 con desviación estándar de 100. 
La facultad de ingeniería establece 550 como calificación mínima en matemáticas para estudiantes de nuevo ingreso. ¿Qué porcentaje de estudiantes obtendrá una calificación por debajo de 550 en el próximo semestre?

```{r echo=FALSE, fig.align="center"}
media <- 480
desviacion <- 100

## P(X <= 550)
sol9 <- pnorm(550, mean = media, sd = desviacion)
cat("La probabilidad ", sol9)

##Grafica
x. <- rnorm(n = 1000,mean = media,sd = desviacion)   ## Genero 1000 datos aleatorios
y. <- dnorm(x = x., mean = media, sd = desviacion)   ## Aplico la función normal
df1 <- data.frame(x.,y.)

ggplot(df1, aes(x=x., y=y.))+
  geom_line(col = "skyblue4") +
  geom_segment(x = media, xend= media, y = 0, yend = dnorm(media, mean = media, sd = desviacion), linetype = "dashed", col = "green3")+
  labs(title = "Grafica normal de los resultados de los examenen de la UNAL") +
  theme_minimal()
```
## Noveno punto

9.  Una planta de producción industrial registra que el tiempo (en días) que transcurre entre una falla y la siguiente en una máquina específica sigue una distribución exponencial con parámetro λ=0,2. ¿Cuál es la probabilidad de que la máquina funcione al menos 10 días sin fallar?  

```{r echo=FALSE, fig.align="center"}
lambda <- 0.2

# P(X ≥ 10)
sol10 <- 1 - pexp(10, rate = lambda)
cat("La probabilidad de que funcione al menos 10 días sin fallar es:", sol10)
```
